<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="iOS14å‰ªåˆ‡æ¿æ¢ç©¶ï¼Œæ·˜å®å®ç°æ–¹æ³•åˆ†æå’Œå®ç°Demo"><meta name="keywords" content="iOS"><meta name="author" content="y500"><meta name="copyright" content="y500"><title>iOS14å‰ªåˆ‡æ¿æ¢ç©¶ï¼Œæ·˜å®å®ç°æ–¹æ³•åˆ†æå’Œå®ç°Demo | study and record</title><link rel="shortcut icon" href="/melody-favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.7.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.7.0"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  }
} </script><meta name="generator" content="Hexo 4.2.0"></head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="true"><div class="toggle-sidebar-info text-center"><span data-toggle="Toggle article">Toggle site</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">Catalog</div><div class="sidebar-toc__progress"><span class="progress-notice">You've read</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="/img/avatar.png"></div><div class="author-info__name text-center">y500</div><div class="author-info__description text-center"></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">Articles</span><span class="pull-right">12</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">Tags</span><span class="pull-right">11</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">Categories</span><span class="pull-right">5</span></a></div></div></div><div id="content-outer"><div class="no-bg" id="top-container"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">study and record</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus">   <a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a><a class="site-page" href="/categories">Categories</a></span><span class="pull-right"></span></div><div id="post-info"><div id="post-title">iOS14å‰ªåˆ‡æ¿æ¢ç©¶ï¼Œæ·˜å®å®ç°æ–¹æ³•åˆ†æå’Œå®ç°Demo</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-09-27</time><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/Objective-C/">Objective-C</a></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><p>éšç€iOS 14çš„å‘å¸ƒï¼Œå‰ªåˆ‡æ¿çš„æ»¥ç”¨ä¹Ÿè¢«å¤§å®¶æ‰€çŸ¥æ™“ã€‚åªè¦æ˜¯APPè¯»å–å‰ªåˆ‡æ¿å†…å®¹ï¼Œç³»ç»Ÿéƒ½ä¼šåœ¨é¡¶éƒ¨å¼¹å‡ºæé†’ï¼Œè€Œä¸”è¿™ä¸ªæé†’ä¸èƒ½å¤Ÿå…³é—­ã€‚è¿™æ ·ï¼Œå¤§å®¶åœ¨ä½¿ç”¨APPçš„è¿‡ç¨‹ä¸­å°±èƒ½å¤Ÿçœ‹åˆ°å“ªäº›APPä½¿ç”¨äº†å‰ªåˆ‡æ¿ã€‚</p>
<p>æ­£å¥½æˆ‘ä»¬è‡ªå·±çš„åº”ç”¨ä¹Ÿä½¿ç”¨äº†å‰ªåˆ‡æ¿ï¼Œå‡çº§äº†iOS 14ä¹‹åå¼¹çš„ç€å®è®©äººå¿ƒçƒ¦ã€‚å°±æƒ³ç€æ€ä¹ˆå¤„ç†ä¸€ä¸‹ï¼Œç¿»äº†ä¸€ä¸‹<code>UIPasteboard</code>çš„æ–‡æ¡£ï¼Œå‘ç°ç›¸å…³çš„å†…å®¹å¹¶ä¸å¤šã€‚<br>è¯»å–<code>UIPasteboard</code>çš„<code>string</code>ã€<code>strings</code>ã€<code>URL</code>ã€<code>URLs</code>ã€<code>image</code>ã€<code>images</code>ã€<code>color</code>ã€<code>colors</code>çš„æ—¶å€™ä¼šè§¦å‘ç³»ç»Ÿæç¤ºã€‚<br>ä½¿ç”¨<code>hasStrings</code>ã€<code>hasURLs</code>ã€<code>hasImages</code>ã€<code>hasColors</code>ç­‰æ–¹æ³•çš„æ—¶å€™ä¸ä¼šè§¦å‘ç³»ç»Ÿæç¤ºã€‚<br>é‚£ä¹ˆæ€è·¯å°±æ˜¯å°½å¯èƒ½å°‘çš„å»è°ƒç”¨ä¼šè§¦å‘ç³»ç»Ÿæç¤ºçš„æ–¹æ³•ï¼Œæ ¹æ®å…¶ä»–æ–¹æ³•å»åˆ¤æ–­ç¡®å®éœ€è¦è¯»å–çš„æ—¶å€™å†å»è°ƒç”¨é‚£äº›æ–¹æ³•ã€‚<br>æ ¹æ®æˆ‘ä»¬è‡ªå·±çš„æƒ…å†µï¼Œåªæœ‰åˆ¤æ–­<code>hasStrings</code>ä¸º<code>YES</code>å°±å»è¯»å–ï¼Œåˆä¸èƒ½æ¸…å‰ªåˆ‡æ¿ï¼Œå…¶å®è¿˜æ˜¯æœ‰ç‚¹ä¸å°½äººæ„ï¼Œç„¶ååˆçœ‹åˆ°è¿™ä¸ªå±æ€§ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@property(readonly, nonatomic) NSInteger changeCount;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">The number of times the pasteboardâ€™s contents have changed.</span><br><span class="line"></span><br><span class="line">Whenever the contents of a pasteboard changesâ€”specifically, when pasteboard items are added, modified, or removedâ€”UIPasteboard increments the value of this property. After it increments the change count, UIPasteboard posts the notifications named UIPasteboardChangedNotification (for additions and modifications) and UIPasteboardRemovedNotification (for removals). These notifications include (in the userInfo dictionary) the types of the pasteboard items added or removed. Because UIPasteboard waits until the end of the current event loop before incrementing the change count, notifications can be batched. The class also updates the change count when an app reactivates and another app has changed the pasteboard contents. When users restart a device, the change count is reset to zero.</span><br></pre></td></tr></table></figure>
<p>ç„¶åå°±åˆåŠ äº†ä¸€ä¸ªæ¡ä»¶ï¼Œè®°å½•ä¸€ä¸‹çœŸæ­£è¯»å–å‰ªåˆ‡æ¿æ—¶çš„<code>changeCount</code>ï¼Œå¦‚æœä¸‹æ¬¡è¯»å–çš„æ—¶å€™æ²¡æœ‰å‘ç”Ÿå˜åŒ–åˆ™ä¸è¯»å–ã€‚<br>è¿™æ ·ä¸€æ¥æ•ˆæœå°±å¥½å¤šäº†ï¼Œåº”ç”¨è¿è¡Œç”Ÿå‘½å‘¨æœŸå†…ï¼ŒåŸºæœ¬ä¸Šåªä¼šå¼¹å‡ºä¸€æ¬¡æç¤ºã€‚</p>
<p>ä½†æ˜¯ï¼Œåæ¥çœ‹åˆ°æ·˜å®æ›´ç‰›é€¼ï¼Œå‘½ä¸­äº†çœŸæ­£åˆ†äº«å‡ºæ¥çš„å†…å®¹æ‰ä¼šå¼¹ï¼Œå…¶ä»–åˆ™ä¸ä¼šå¼¹ã€‚ç„¶åå°±ç ”ç©¶äº†ä¸€ä¸‹æ·˜å®çš„åˆ†äº«å†…å®¹å’Œæ–°çš„APIæ–‡æ¡£ï¼Œå¤§æ¦‚å¾—åˆ°äº†ç­”æ¡ˆã€‚<br>å…ˆçœ‹ä¸‹æ·˜å®çš„åˆ†äº«å†…å®¹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">9ğŸ‘ˆå¹…æ²»å†…å®¹ Http:&#x2F;T$AJg8c4IfW3q$æ‰“é–‹ğŸ‘‰ç»¹..å¯¶ğŸ‘ˆã€è´µå·èŒ…å°é…’ èŒ…å° é£å¤©53åº¦é…±é¦™å‹ç™½é…’æ”¶è— 500ml*1å•ç“¶è£…é€ç¤¼é«˜åº¦ã€‘</span><br></pre></td></tr></table></figure>
<p>ç»„æˆéƒ¨åˆ†ï¼šæ•°å­—+æ–‡å­—+é“¾æ¥çš„å½¢åŠ¿ï¼Œå†ç»“åˆiOS 14æä¾›çš„æ–°APIï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">detectPatternsForPatterns:completionHandler:</span><br><span class="line">detectPatternsForPatterns:inItemSet:completionHandler:</span><br></pre></td></tr></table></figure>

<p>è€Œ<code>UIPasteboardDetectionPattern</code>ç³»ç»Ÿåªæä¾›äº†ä¸‰ç§ï¼š</p>
<ol>
<li>æ•°å­— <code>UIPasteboardDetectionPatternNumber</code></li>
<li>é“¾æ¥ <code>UIPasteboardDetectionPatternProbableWebURL</code></li>
<li>æœç´¢<code>UIPasteboardDetectionPatternProbableWebSearch</code></li>
</ol>
<p>å¤§èƒ†çŒœæµ‹ï¼Œæ·˜å®åº”è¯¥æ˜¯é€šè¿‡åˆ¤æ–­æ˜¯å¦ç¬¦åˆæ•°å­—å’Œé“¾æ¥çš„è§„åˆ™æ¥åˆ¤æ–­æ˜¯å¦å‘½ä¸­åˆ†äº«å†…å®¹ã€‚</p>
<p>ç„¶åå°±å†™äº†ä¸€ä¸ªdemoæ¥éªŒè¯ï¼Œæ ¸å¿ƒä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">UIPasteboard *board &#x3D; [UIPasteboard generalPasteboard];</span><br><span class="line">    </span><br><span class="line">[board detectPatternsForPatterns:[NSSet setWithObjects:UIPasteboardDetectionPatternProbableWebURL, UIPasteboardDetectionPatternNumber, UIPasteboardDetectionPatternProbableWebSearch, nil]</span><br><span class="line">                   completionHandler:^(NSSet&lt;UIPasteboardDetectionPattern&gt; * _Nullable set, NSError * _Nullable error) &#123;</span><br><span class="line">        </span><br><span class="line">        BOOL hasNumber &#x3D; NO, hasURL &#x3D; NO;</span><br><span class="line">        for (NSString *type in set) &#123;</span><br><span class="line">            if ([type isEqualToString:UIPasteboardDetectionPatternProbableWebURL]) &#123;</span><br><span class="line">                hasURL &#x3D; YES;</span><br><span class="line">            &#125; else if ([type isEqualToString:UIPasteboardDetectionPatternNumber]) &#123;</span><br><span class="line">                hasNumber &#x3D; YES;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        if (hasNumber &amp;&amp; hasURL) &#123;</span><br><span class="line">            </span><br><span class="line">            dispatch_async(dispatch_get_main_queue(), ^&#123;</span><br><span class="line">                UIAlertController *alert &#x3D; [UIAlertController alertControllerWithTitle:@&quot;æ¸©é¦¨æç¤º&quot; message:[NSString stringWithFormat:@&quot;%@\n%@&quot;, [board string], @&quot;ç¬¦åˆæ·˜å®çš„è¯»å–æ ‡å‡†&quot;] preferredStyle:UIAlertControllerStyleAlert];</span><br><span class="line">                UIAlertAction *cancelAction &#x3D; [UIAlertAction actionWithTitle:@&quot;ç¡®å®š&quot; style:UIAlertActionStyleCancel handler:nil];</span><br><span class="line">                [alert addAction:cancelAction];</span><br><span class="line">                [self presentViewController:alert animated:YES completion:nil];</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;];</span><br></pre></td></tr></table></figure>

<p>ç„¶åæ„é€ äº†ä¸€ä¸ªçœ‹èµ·æ¥ç¬¦åˆæ¡ä»¶<code>1 http:/123abc</code>çš„ä¸²å»åå‘éªŒè¯äº†ä¸€ä¸‹å‘ç°demoå’Œæ·˜å®çš„ç»“æœçš„è¡¨ç°æ˜¯ä¸€è‡´çš„ï¼Œéƒ½å¼¹äº†ç³»ç»Ÿæç¤ºã€‚</p>
<p>å…·ä½“çš„demoå¯å»<a href="https://github.com/y500/ios14_uipasteboard" target="_blank" rel="noopener">github</a>ä¸‹è½½ã€‚</p>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">y500</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://www.y500.me/2020/09/27/ios14_taobao_uipasteboard/">https://www.y500.me/2020/09/27/ios14_taobao_uipasteboard/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/iOS/">iOS</a></div><nav id="pagination"><div class="prev-post pull-left"><a href="/2020/09/29/image-not-render-on-ios14/"><i class="fa fa-chevron-left">  </i><span>iOS 14ä¸‹é¢å›¾ç‰‡æ— æ³•åŠ è½½ï¼ŒåŒ…æ‹¬weexã€YYAnimateViewã€SDAnimatedImageView</span></a></div><div class="next-post pull-right"><a href="/2020/09/25/flutter-xcode12-ios14-crash/"><span>iOS14 debugå®‰è£…çš„å¸¦æœ‰flutteråº”ç”¨ä»æ¡Œé¢å›¾æ ‡é‡æ–°å¯åŠ¨æ—¶é—ªé€€</span><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2013 - 2020 By y500</div><div class="framework-info"><span>Driven - </span><a href="http://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme - </span><a href="https://github.com/Molunerfinn/hexo-theme-melody" target="_blank" rel="noopener"><span>Melody</span></a></div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.7.0"></script><script src="/js/fancybox.js?version=1.7.0"></script><script src="/js/sidebar.js?version=1.7.0"></script><script src="/js/copy.js?version=1.7.0"></script><script src="/js/fireworks.js?version=1.7.0"></script><script src="/js/transition.js?version=1.7.0"></script><script src="/js/scroll.js?version=1.7.0"></script><script src="/js/head.js?version=1.7.0"></script><script>if(/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
  $('#top-container').addClass('is-mobile')
}</script></body></html>